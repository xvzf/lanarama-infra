



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Topology - Lanarama Infrastrucutre Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#network-topology" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Lanarama Infrastrucutre Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Lanarama Infrastrucutre Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Topology
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Lanarama Infrastrucutre Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Lanarama Infrastrucutre Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fail/" title="Read this first" class="md-nav__link">
      Read this first
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Topology
      </label>
    
    <a href="./" title="Topology" class="md-nav__link md-nav__link--active">
      Topology
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hardware-overview" title="Hardware overview" class="md-nav__link">
    Hardware overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-layer" title="Core layer" class="md-nav__link">
    Core layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highspeed-access-layer" title="Highspeed access layer" class="md-nav__link">
    Highspeed access layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uplink-layer" title="Uplink Layer" class="md-nav__link">
    Uplink Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-layer" title="Service Layer" class="md-nav__link">
    Service Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-layer" title="Access Layer" class="md-nav__link">
    Access Layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgp-internals" title="BGP internals" class="md-nav__link">
    BGP internals
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-layer_1" title="Core layer" class="md-nav__link">
    Core layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uplink-layer_1" title="Uplink layer" class="md-nav__link">
    Uplink layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-layer_1" title="Service layer" class="md-nav__link">
    Service layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-layer_1" title="Access layer" class="md-nav__link">
    Access layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../network_connectivity/" title="Connectivity" class="md-nav__link">
      Connectivity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../network_debugging/" title="Debugging" class="md-nav__link">
      Debugging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hardware-overview" title="Hardware overview" class="md-nav__link">
    Hardware overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-layer" title="Core layer" class="md-nav__link">
    Core layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#highspeed-access-layer" title="Highspeed access layer" class="md-nav__link">
    Highspeed access layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uplink-layer" title="Uplink Layer" class="md-nav__link">
    Uplink Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-layer" title="Service Layer" class="md-nav__link">
    Service Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-layer" title="Access Layer" class="md-nav__link">
    Access Layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgp-internals" title="BGP internals" class="md-nav__link">
    BGP internals
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-layer_1" title="Core layer" class="md-nav__link">
    Core layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uplink-layer_1" title="Uplink layer" class="md-nav__link">
    Uplink layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-layer_1" title="Service layer" class="md-nav__link">
    Service layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-layer_1" title="Access layer" class="md-nav__link">
    Access layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="network-topology">Network Topology</h1>
<blockquote>
<p>Network connectivity heavily relies on the BGP(4) protocol. Each access switch has its own AS number (detailed information following) and peers with both core switches which also have their own AS number.</p>
</blockquote>
<h2 id="hardware-overview">Hardware overview</h2>
<h3 id="core-layer">Core layer</h3>
<p>The two core switches consists of two <em>Arista DCS7050SX-64</em> which peer via an 80 Gigabit interconnect. Ideally this link never sees much traffic and if so, something is going wrong with routing or there is a physical damage on the connection between one of the core switches and one of the access switches.</p>
<h3 id="highspeed-access-layer">Highspeed access layer</h3>
<p>tbd</p>
<h3 id="uplink-layer">Uplink Layer</h3>
<p>Currently there is one Uplink gateway which is "just" a <em>Dell R420</em> (2x E5-2430v2, 64GB DDR3) NATing with nftables and forwarding IPv6 traffic. It peers with the Core layer and advertises a default route.</p>
<h3 id="service-layer">Service Layer</h3>
<p>Servers are also integrated here. Hardware varies.</p>
<h3 id="access-layer">Access Layer</h3>
<p>We currently have 7 access switches planned (<em>Penguin Computing 4804i-q</em>) which have a 10 Gigabit connection to <strong>each</strong> of the core switches. ECMP (<strong>E</strong>qual <strong>C</strong>ost <strong>M</strong>ultipath <strong>R</strong>outing) is enabled which ensures the switch routes packets over both link simultaniously. The switch performs a hash algorithm on the source/destination and decides on which link to send the packet.</p>
<h2 id="bgp-internals">BGP internals</h2>
<blockquote>
<p>We are using the private 16bit AS-range for our network.</p>
</blockquote>
<h3 id="core-layer_1">Core layer</h3>
<blockquote>
<p>Core switches are running Aristas EOS.</p>
</blockquote>
<ul>
<li><strong>core0</strong> -&gt; <strong>AS64666</strong></li>
<li><strong>core1</strong> -&gt; <strong>AS64667</strong></li>
</ul>
<h3 id="uplink-layer_1">Uplink layer</h3>
<blockquote>
<p>The uplink gateway is running <a href="https://frrouting.org">frrouting</a> and advertises a default route.</p>
</blockquote>
<ul>
<li><strong>heaven0</strong> -&gt; <strong>AS65001</strong></li>
</ul>
<h3 id="service-layer_1">Service layer</h3>
<blockquote>
<p>Our servers are also running <a href="https://frrouting.org">frrouting</a> and advertises their internal network via BGP.</p>
</blockquote>
<ul>
<li><strong>kvm0</strong> -&gt; <strong>AS64801</strong></li>
</ul>
<h3 id="access-layer_1">Access layer</h3>
<blockquote>
<p>The access switches are running the (seemingly acient) <a href="https://www.quagga.net">quagga</a> routing suite.</p>
</blockquote>
<ul>
<li><strong>access1</strong> -&gt; <strong>AS64701</strong></li>
<li><strong>access2</strong> -&gt; <strong>AS64702</strong></li>
<li><strong>access3</strong> -&gt; <strong>AS64703</strong></li>
<li><strong>access4</strong> -&gt; <strong>AS64704</strong></li>
<li><strong>access5</strong> -&gt; <strong>AS64705</strong></li>
<li><strong>access6</strong> -&gt; <strong>AS64706</strong></li>
<li><strong>access7</strong> -&gt; <strong>AS64707</strong></li>
</ul>
<h1 id="connecting-to-the-switches">Connecting to the switches</h1>
<p>Every switch has a unique IP which is advertised and should be available from each point in the network. It is derived from the AS number.</p>
<p>Some examples:</p>
<ul>
<li><em>64666</em> -&gt; <em>10.64.66.6/32</em></li>
<li><em>64702</em> -&gt; <em>10.64.70.2/32</em></li>
<li><em>65001</em> -&gt; <em>10.65.0.1/32</em></li>
</ul>
<h1 id="peering">Peering</h1>
<blockquote>
<p><strong>ATTENTION</strong> The BGP daemon on the core switches is listening only on the IPv6 address range! (more specific: <code>fc00::/16</code>)</p>
</blockquote>
<p>Peering is possible at the coreswitches on Port 1-16 (10 Gbit) as well as 49-52 (40 Gbit, 51 and 52 split up to 4x10G for Server connections) following this schema (IPv4, IPv6). All ASes are accepted!</p>
<pre><code>  10.&lt;core-id&gt;.&lt;port-index&gt;.1/30
  fc00:&lt;core-id&gt;:&lt;port-index&gt;::1/126
</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../fail/" title="Read this first" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Read this first
              </span>
            </div>
          </a>
        
        
          <a href="../network_connectivity/" title="Connectivity" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Connectivity
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>